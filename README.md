## 개요

- Account(계좌) 시스템은 사용자와 계좌의 정보를 저장하고 있으며, 외부 시스템에서 거래를 요청할 경우 거래 정보를 받아서 계좌에서 잔액을 거래금액만큼 줄이거나(결제), 거래금액만큼 늘리는(결제 취소) 거래 관리 기능을 제공하는 시스템입니다.
- 구현의 편의를 위해 사용자 생성 등의 관리는 API로 제공하지 않고 프로젝트 시작 시 자동으로 데이터가 입력되도록 하며, 계좌 추가/해지/확인, 거래 생성/거래 취소/거래 확인의 6가지 API를 제공합니다.
* 거래금액을 늘리거나 줄이는 과정에서 여러 쓰레드 혹은 인스턴스에서 같은 계좌에 접근할 경우 동시성 이슈로 인한 lost update가 발생할 수 있으므로 이 부분을 해결해야만 합니다.

## 공통 요구사항

- Spring boot와 Java를 활용합니다.
- 단위테스트를 작성하여 작성한 코드를 검증합니다.
- DB는 H2 DB(memory DB 모드)를 활용합니다.
- DB를 접근하는 방법은 Spring data jpa를 활용합니다.
- Embedded redis를 활용합니다.
- API Request body와 Response body는 json 타입으로 표현합니다.
- 각각의 API들은 각자의 요청과 응답 객체 구조를 갖습니다. (다만, 요청을 처리하다가 실패하는 경우의 응답은 공통된 구조를 갖도록 합니다.)

## API 명세

### 계좌 관련 API

1) 계좌 생성    
   a. 파라미터 : 사용자 아이디, 초기 잔액  
   b. 결과  
   i. 실패 : 사용자 없는 경우, 계좌가 10개(사용자당 최대 보유 가능 계좌) 인 경우 실패 응답  
   ii. 성공
- 계좌번호는 10자리 랜덤 숫자  
- 응답정보 : 사용자 아이디, 생성된 계좌 번호, 등록일시(LocalDateTime)

[ 계좌생성 시 주의사항 ]
- 계좌 생성 시 계좌 번호는 10자리의 정수로 구성되며, 기존에 동일 계좌 번호가 있는지 중복체크를 해야 합니다.
- 기본적으로 계좌번호는 순차 증가 방식으로 생성한다. (응용하는 방식으로는 계좌 번호를 랜덤 숫자 10자리로 구성하는 것도 가능하며, 랜덤생성이 현업과 더욱 유사하니 참고해주세요.)

2) 계좌 해지  
   a. 파라미터 : 사용자 아이디, 계좌 번호 
   b. 결과  
   i. 실패 : 사용자 없는 경우, 사용자 아이디와 계좌 소유주가 다른 경우, 계좌가 이미 해지 상태인 경우, 잔액이 있는 경우 실패 응답  
   ii. 성공  
- 응답 : 사용자 아이디, 계좌번호, 해지일시

3) 계좌 확인  
   a. 파라미터 : 사용자 아이디  
   b. 결과  
   i. 실패 : 사용자 없는 경우 실패 응답  
   ii. 성공  
- 응답 : (계좌번호, 잔액) 정보를 Json list 형식으로 응답


## 패키지 구조
```
- aop : AOP로 중복 거래 방지 락을 걸때 사용될 어노테이션을 위치 시킴
- config : redis 관련 설정 및 클라이언트 빈 등록, JPA 관련 설정 등록
- controller : API의 endpoint를 등록하고, 요청/응답의 형식을 갖는 클래스 패키지
- domain : jpa entity (테이블)
- dto : DTO(Data Transfer Object)를 위치시키는 곳
    * Controller에서 요청/응답에 사용할 클래스
    * 로직 내부에서 데이터 전송에 사용할 클래스
- exception : 커스텀 Exception, Exception Handler 클래스 패키지
- repository : Repository(DB에 연결할 때 사용하는 인터페이스)가 위치하는 패키지
- service : 비즈니스 로직을 담는 서비스 패키지
- type : 상태타입, 에러코드, 거래종류 등의 다양한 enum class들의 패키지
``` 